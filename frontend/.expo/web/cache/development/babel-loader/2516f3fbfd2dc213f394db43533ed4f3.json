{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport UserModel from \"../model/user_model\";\nimport COLORS from \"../constants/colors\";\nimport ActivityIndicator from \"./component/custom_activity_indicator\";\nimport CustomImagePicker from \"./component/custom_image_picker\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Edit_User = function Edit_User(_ref) {\n  var _route$params;\n  var navigation = _ref.navigation,\n    route = _ref.route;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var _useState3 = useState(\"\"),\n    _useState4 = _slicedToArray(_useState3, 2),\n    UserName = _useState4[0],\n    setUserName = _useState4[1];\n  var _useState5 = useState(\"\"),\n    _useState6 = _slicedToArray(_useState5, 2),\n    UserNameOld = _useState6[0],\n    setUserNameOld = _useState6[1];\n  var _useState7 = useState(\"\"),\n    _useState8 = _slicedToArray(_useState7, 2),\n    Password = _useState8[0],\n    setPassword = _useState8[1];\n  var _useState9 = useState(\"\"),\n    _useState10 = _slicedToArray(_useState9, 2),\n    imageUri = _useState10[0],\n    setImageUri = _useState10[1];\n  var _useState11 = useState(\"\"),\n    _useState12 = _slicedToArray(_useState11, 2),\n    userId = _useState12[0],\n    setUserId = _useState12[1];\n  var _useState13 = useState(\"\"),\n    _useState14 = _slicedToArray(_useState13, 2),\n    accessToken = _useState14[0],\n    setAccessToken = _useState14[1];\n  var _useState15 = useState(\"\"),\n    _useState16 = _slicedToArray(_useState15, 2),\n    refreshToken = _useState16[0],\n    setRefreshToken = _useState16[1];\n  var _useState17 = useState(\"\"),\n    _useState18 = _slicedToArray(_useState17, 2),\n    firstname = _useState18[0],\n    setFirstname = _useState18[1];\n  var getUser = function () {\n    var _ref2 = _asyncToGenerator(function* (userID) {\n      var user = yield UserModel.getUserById(userID);\n      setUserName(user.email);\n      setUserNameOld(user.email);\n      setPassword(user.password);\n      setImageUri(user.imageUri.toString());\n      setFirstname(user.email);\n      console.log(\"GETUSER \" + user.imageUri);\n      return user;\n    });\n    return function getUser(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  React.useEffect(function () {\n    var usrc = {\n      _id: route.params.user._id,\n      access_token: route.params.user.access_token,\n      refresh_token: route.params.user.refresh_token\n    };\n    console.log(usrc);\n    var user = getUser(usrc._id);\n    setUserId(usrc._id);\n    setAccessToken(usrc.access_token);\n    setRefreshToken(usrc.refresh_token);\n  }, [(_route$params = route.params) == null ? void 0 : _route$params.user]);\n  var onSave = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      setIsLoading(true);\n      if (UserName != \"\" && Password != \"\") {\n        var user = {\n          email: UserName,\n          password: Password,\n          imageUri: ''\n        };\n        if (imageUri != \"\") {\n          console.log(\"saving image\");\n          var url = yield UserModel.uploadImage(imageUri, accessToken);\n          user.imageUri = url;\n          console.log(\"saving image : \" + url);\n        }\n        yield UserModel.updateUser(user, UserNameOld, accessToken, userId);\n        setIsLoading(false);\n        navigation.navigate(\"Home\", {\n          _id: userId,\n          accessToken: accessToken,\n          refreshToken: refreshToken\n        });\n      }\n    });\n    return function onSave() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var onImageSelected = function onImageSelected(uri) {\n    console.log(\"onImageSelected \" + uri);\n    setImageUri(uri);\n  };\n  return _jsx(ScrollView, {\n    children: _jsxs(View, {\n      style: styles.container,\n      children: [_jsx(View, {\n        style: styles.image,\n        children: _jsx(CustomImagePicker, {\n          image: imageUri,\n          onImageSelected: onImageSelected\n        })\n      }), _jsx(TextInput, {\n        style: styles.textInput,\n        onChangeText: setUserName,\n        placeholder: firstname.toString(),\n        keyboardType: \"default\"\n      }), _jsx(TouchableHighlight, {\n        underlayColor: COLORS.clickBackground,\n        onPress: function onPress() {\n          onSave();\n        },\n        style: styles.button,\n        children: _jsx(Text, {\n          style: styles.buttonText,\n          children: \"Save\"\n        })\n      }), _jsx(View, {\n        style: styles.activity_indicator,\n        children: _jsx(ActivityIndicator, {\n          visible: isLoading\n        })\n      })]\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  image: {\n    width: \"100%\",\n    height: 250,\n    resizeMode: \"contain\"\n  },\n  textInput: {\n    height: 40,\n    margin: 12,\n    borderWidth: 1,\n    padding: 10,\n    borderColor: \"grey\"\n  },\n  button: {\n    margin: 12,\n    backgroundColor: \"grey\",\n    borderRadius: 50\n  },\n  buttonText: {\n    fontSize: 40,\n    color: \"white\",\n    textAlign: \"center\",\n    marginTop: 3,\n    marginBottom: 3\n  },\n  activity_indicator: {\n    position: \"absolute\",\n    justifyContent: \"center\",\n    width: \"100%\",\n    height: \"100%\",\n    alignItems: \"center\"\n  }\n});\nexport default Edit_User;","map":{"version":3,"names":["React","useState","View","Text","StyleSheet","TextInput","TouchableHighlight","ScrollView","UserModel","COLORS","ActivityIndicator","CustomImagePicker","jsx","_jsx","jsxs","_jsxs","Edit_User","_ref","_route$params","navigation","route","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","UserName","setUserName","_useState5","_useState6","UserNameOld","setUserNameOld","_useState7","_useState8","Password","setPassword","_useState9","_useState10","imageUri","setImageUri","_useState11","_useState12","userId","setUserId","_useState13","_useState14","accessToken","setAccessToken","_useState15","_useState16","refreshToken","setRefreshToken","_useState17","_useState18","firstname","setFirstname","getUser","_ref2","_asyncToGenerator","userID","user","getUserById","email","password","toString","console","log","_x","apply","arguments","useEffect","usrc","_id","params","access_token","refresh_token","onSave","_ref3","url","uploadImage","updateUser","navigate","onImageSelected","uri","children","style","styles","container","image","textInput","onChangeText","placeholder","keyboardType","underlayColor","clickBackground","onPress","button","buttonText","activity_indicator","visible","create","flex","width","height","resizeMode","margin","borderWidth","padding","borderColor","backgroundColor","borderRadius","fontSize","color","textAlign","marginTop","marginBottom","position","justifyContent","alignItems"],"sources":["/Users/ohadshalom/Desktop/devops_projects/cicd_project/frontend/screens/edit_user_details.tsx"],"sourcesContent":["import React, { FC, useState } from \"react\";\nimport { View, Text ,StyleSheet ,Image, TextInput, TouchableHighlight, ScrollView} from \"react-native\";\nimport UserModel,{User} from \"../model/user_model\"\nimport COLORS from \"../constants/colors\";\nimport ActivityIndicator from \"./component/custom_activity_indicator\";\nimport CustomImagePicker from \"./component/custom_image_picker\";\nimport { UserCredentials } from \"../model/user_model\";\n\nconst Edit_User: FC<{ navigation: any; route:any }> = ({navigation, route}) => {\n    const [isLoading,setIsLoading] =useState<boolean>(false)\n    const [UserName,setUserName] = useState<String>(\"\")\n    const [UserNameOld,setUserNameOld] = useState<String>(\"\")\n    const [Password,setPassword] = useState<String>(\"\")\n    const [imageUri,setImageUri] = useState<String>(\"\")\n    const [userId,setUserId] = useState<String>(\"\");\n    const [accessToken,setAccessToken] = useState<String>(\"\")\n    const [refreshToken,setRefreshToken] = useState<String>(\"\")\n    const [firstname,setFirstname] = useState<String>(\"\")\n    const getUser=async (userID:String)=>{\n      const user = await UserModel.getUserById(userID)\n      setUserName(user.email)\n      setUserNameOld(user.email)\n      setPassword(user.password)\n      setImageUri(user.imageUri.toString())\n      setFirstname(user.email)\n      console.log(\"GETUSER \"+user.imageUri);\n      \n      return user\n  }\n    React.useEffect(()=>{\n      const usrc:UserCredentials = {\n        _id:route.params.user._id,\n        access_token:route.params.user.access_token,\n        refresh_token:route.params.user.refresh_token\n      }\n      console.log(usrc);\n        const user = getUser(usrc._id)\n        setUserId(usrc._id)\n        setAccessToken(usrc.access_token)\n        setRefreshToken(usrc.refresh_token)\n      \n    },[route.params?.user])\n\n    const onSave = async ()=>{\n      setIsLoading(true)\n      if(UserName!=\"\" && Password !=\"\" ){\n        const user:User = {\n          email:UserName,\n          password:Password,\n          imageUri: ''\n        }\n        if(imageUri != \"\"){\n          console.log(\"saving image\")\n          const url = await UserModel.uploadImage(imageUri,accessToken)\n          user.imageUri = url\n          console.log(\"saving image : \" + url) \n      }\n      \n        await UserModel.updateUser(user,UserNameOld,accessToken,userId)\n        setIsLoading(false)\n        navigation.navigate(\"Home\",{_id:userId,accessToken:accessToken,refreshToken:refreshToken})\n      }\n    }\n\n\n\n\n    const onImageSelected = (uri:String)=>{\n      console.log(\"onImageSelected \" + uri)\n      setImageUri(uri)\n  }\n    return (\n      <ScrollView>\n      <View style={styles.container}>\n      <View style={styles.image} >\n        <CustomImagePicker image={imageUri} onImageSelected={onImageSelected}></CustomImagePicker>\n      </View>\n      <TextInput style={styles.textInput} onChangeText={setUserName} placeholder={firstname.toString()} keyboardType=\"default\"></TextInput>\n      <TouchableHighlight\n        underlayColor={COLORS.clickBackground} \n        onPress={()=>{ \n          onSave()\n        }} \n        style={styles.button}>\n         <Text style={styles.buttonText}>Save</Text>\n       </TouchableHighlight>\n\n       \n       <View style={styles.activity_indicator}>\n        <ActivityIndicator visible ={isLoading}></ActivityIndicator> \n       </View>\n      </View>\n      </ScrollView>\n    );\n  };\n\n  const styles = StyleSheet.create({\n      container:{\n        flex:1\n      },\n      image:{\n        width:\"100%\",\n        height:250,\n        resizeMode:\"contain\",\n      },\n      textInput:{\n        height:40,\n        margin:12,\n        borderWidth:1,\n        padding:10,\n        borderColor:\"grey\",\n      },\n      button:{\n        margin:12,\n        backgroundColor:\"grey\",\n        borderRadius:50\n      },\n      buttonText:{\n        fontSize:40,\n        color:\"white\",\n        textAlign: \"center\",\n        marginTop:3,\n        marginBottom:3\n      },\n      activity_indicator:{\n        position:\"absolute\",\n    justifyContent:\"center\",\n    width:\"100%\",\n    height:\"100%\",\n    alignItems:\"center\"\n      }\n  })\n\n  export default Edit_User"],"mappings":"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"},"metadata":{},"sourceType":"module"}